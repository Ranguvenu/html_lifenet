define("auth_otp/dynamicform",["exports","core_form/modalform","core/pending","core/modal_factory","core/modal_events","core/notification","core/ajax","core/str"],(function(_exports,_modalform,_pending,_modal_factory,_modal_events,_notification,_ajax,_str){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.default=void 0,_modalform=_interopRequireDefault(_modalform),_pending=_interopRequireDefault(_pending),_modal_factory=_interopRequireDefault(_modal_factory),_modal_events=_interopRequireDefault(_modal_events),_notification=_interopRequireDefault(_notification),_ajax=_interopRequireDefault(_ajax);class OTPynamicForm extends _modalform.default{constructor(){var obj,key,value;super(...arguments),value={FORM_SUBMITTED:"core_form_modalform_formsubmitted",FORM_CANCELLED:"core_form_modalform_formcancelled",CLIENT_VALIDATION_ERROR:"core_form_modalform_clientvalidationerror",SERVER_VALIDATION_ERROR:"core_form_modalform_validationerror",ERROR:"core_form_modalform_error",NOSUBMIT_BUTTON_PRESSED:"core_form_modalform_nosubmitbutton",SUBMIT_BUTTON_PRESSED:"core_form_modalform_submitbutton",CANCEL_BUTTON_PRESSED:"core_form_modalform_cancelbutton",LOADED:"core_form_modalform_loaded",CONTENT_LOADED:"local_trainingprogram_dynamicform_content_loaded"},(key="events")in(obj=this)?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value}show(){const pendingPromise=new _pending.default("core_form/modalform:init");return _modal_factory.default.create(this.config.modalConfig).then((modal=>{this.modal=modal;const formParams=new URLSearchParams(Object.entries(this.config.args||{}));this.modal.setLarge(),this.modal.getRoot().addClass("openLMStransition"),this.modal.getRoot().on(_modal_events.default.hidden,function(){this.modal.getRoot().animate({right:"-85%"},500),setTimeout((function(){this.modal.destroy()}),1e3),this.modal.setBody("")}.bind(this)),this.modal.getRoot().animate({right:"0%"},500),this.modal.getFooter().find('[data-action="cancel"]').on("click",(function(){this.modal.setBody(""),this.modal.hide(),setTimeout((function(){this.modal.destroy()}),1e3)})),this.modal.getRoot().find('[data-action="hide"]').on("click",(function(){this.modal.hide(),setTimeout((function(){this.modal.destroy()}),1e3),this.modal.destroy()}));const bodyContent=this.getBody(formParams.toString());return this.modal.setBodyContent(bodyContent),this.modal.getRoot().on(_modal_events.default.bodyRendered,(e=>{this.trigger(this.events.CONTENT_LOADED);var sectors=$("select[name='sectors[]']").val();void 0!==$("#el_segmentlist")&&$("select#el_segmentlist").data("sectorid",sectors),void 0!==$("#el_jobfamily")&&$("#el_jobfamily").data("sectorid",sectors),$("select[name='sectors[]']").on("change",(function(e){var sectors=$(this).val(),segments=$(this).closest("form").find("select[name='segments[]']");segments.val(""),segments.attr("data-sectorid",sectors);var targetgroup=$(this).closest("form").find("select[name='targetgroup[]']");targetgroup.val(""),targetgroup.attr("data-sectorid",sectors)}));sectors=$("select[name='sectors']").val();void 0!==$("#el_segmentlist")&&$("select#el_segmentlist").attr("data-sectorid",sectors),void 0!==$("#el_jobfamily")&&$("#el_jobfamily").attr("data-sectorid",sectors),$("select[name='sectors']").on("change",(function(e){var sectors=$(this).val(),segments=$(this).closest("form").find("select[name='segments[]']"),segment=$(this).closest("form").find("select[name='segment']");segments.val(""),segments.attr("data-sectorid",sectors),segment.val(""),segment.attr("data-sectorid",sectors);var targetgroup=$(this).closest("form").find("select[name='targetgroup[]']");targetgroup.val(""),targetgroup.attr("data-sectorid",sectors)}));var ctype=$("select[name='ctype[]']").val();if(void 0!==$("#el_competencieslist")&&$("select#el_competencieslist").data("ctype",ctype),$("select[name='ctype[]']").on("change",(function(e){var ctype=$(this).val(),competenices=$(this).closest("form").find("select[name='competencylevel[]']");competenices.attr("data-ctype","[]"),ctype=JSON.stringify(ctype),competenices.val(""),competenices.attr("data-ctype",ctype)})),void 0!==$("#el_segmentlist")&&void 0!==$("#el_jobfamily")){sectors=$(".el_sectorlist").val();$("select#el_jobfamily").attr("data-sectorid",sectors);var segments=$("#el_segmentlist").val();$("select#el_jobfamily").attr("data-segmentid",segments)}if($("#el_segmentlist").on("change",(function(e){var segments=$("#el_segmentlist").val();$("select#el_jobfamily").val(""),$("select#el_jobfamily").attr("data-segmentid",segments)})),void 0!==$("#el_jobfamily")&&void 0!==$("#el_jobroles")){var jobfamily=$("#el_jobfamily").val();$("select#el_jobroles").attr("data-jobfamilyid",jobfamily)}$("#el_jobfamily").on("change",(function(e){var jobfamily=$("#el_jobfamily").val();$("select#el_jobroles").val(""),$("select#el_jobroles").attr("data-jobfamilyid",jobfamily)})),$("select[name='startdate[day]']").on("change",(function(e){$(".entityhall .badge-info").html("");(0,_str.get_strings)([{key:"selecthall",component:"local_trainingprogram"}]).then((_ref=>{let[title]=_ref;$(".entityhall .badge-info").html(title)})).catch(),$("select[name='halladdress']").val("0");var params={};params.sessionkey=$("input[name='sesskey']").val(),params.type="tprogram",_ajax.default.call([{methodname:"remove_reservations",args:params}])[0].done((function(resp){$(".entityhalldetails").html(""),console.log("Successfully reservations removed")})).fail((function(){console.log("exception")}))}))})),bodyContent.catch(_notification.default.exception),this.modal.getRoot().on(_modal_events.default.hidden,(()=>{this.notifyResetFormChanges(),this.modal.destroy(),this.config.returnFocus&&this.config.returnFocus.focus()})),this.modal.getModal().addClass("modal-form-dialogue"),this.modal.getRoot().on("click","form input[type=submit][data-no-submit]",(e=>{e.preventDefault();this.trigger(this.events.NOSUBMIT_BUTTON_PRESSED,e.target).defaultPrevented||this.processNoSubmitButton(e.target)})),this.modal.getRoot().on("submit","form",(e=>{e.preventDefault();this.trigger(this.events.SUBMIT_BUTTON_PRESSED).defaultPrevented||this.submitFormAjax()})),void 0!==this.config.saveButtonText&&void 0!==this.modal.setSaveButtonText&&this.modal.setSaveButtonText(this.config.saveButtonText),void 0!==this.config.saveButtonClasses&&this.setSaveButtonClasses(this.config.saveButtonClasses),this.modal.getRoot().on(_modal_events.default.save,(e=>{e.preventDefault(),this.modal.getRoot().find("form").submit()})),this.modal.getRoot().on(_modal_events.default.cancel,(e=>{this.trigger(this.events.CANCEL_BUTTON_PRESSED).defaultPrevented&&e.preventDefault()})),this.futureListeners.forEach((args=>this.modal.getRoot()[0].addEventListener(...args))),this.futureListeners=[],this.trigger(this.events.LOADED,null,!1),this.modal.show()})).then(pendingPromise.resolve)}}return _exports.default=OTPynamicForm,_exports.default}));

//# sourceMappingURL=dynamicform.min.js.map