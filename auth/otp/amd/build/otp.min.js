/**
 * Javascript controller for the "Actions" panel at the bottom of the page.
 *
 * @module     auth_otp/otp
 * @copyright  2021 Brain station 23 <damyon@moodle.com>
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 * @since      3.1
 */
define("auth_otp/otp",["jquery","core/ajax","core/notification"],(function($,Ajax,Notification){$("#sendotp").click((function(){var countrycode=$(".iti__selected-dial-code").html(),fullphone=countrycode+$("#applicationid").val();$('input[name="full_number"]').val(fullphone);var phone=$("#applicationid").val();if(phone){alert(fullphone);if(/^\+[1-9]{1}[0-9]{3,14}$/.test(fullphone)){let timerOn=!0;function timer(remaining){var m=Math.floor(remaining/60),s=remaining%60;m=m<10?"0"+m:m,s=s<10?"0"+s:s,document.getElementById("timer").innerHTML=m+":"+s,(remaining-=1)>=0&&timerOn?setTimeout((function(){timer(remaining)}),1e3):timerOn&&(alert("Timeout for otp"),$("#sendotp").removeAttr("disabled"),document.getElementById("timer").innerHTML="Resend Code",$("#sendotp").removeClass("d-none"))}var request={methodname:"auth_otp_send_sms",args:{phone:phone,countrycode:countrycode}};try{Ajax.call([request])[0].done((function(data){1==data.success?($("#otp-field").removeClass("d-none"),$("#sendotp").attr("disabled","disabled"),$("#applicationid").attr("disabled","disabled"),$("#applicationid").val(phone),$("#username").val(phone),timer(300),Notification.addNotification({message:data.message,type:"success"})):Notification.addNotification({message:"Something went wrong to send otp Please Try again !!",type:"error"})})).fail(Notification.exception)}catch(e){console.log(e)}}else Notification.addNotification({message:"insert Valid Phone number !!",type:"error"})}else Notification.addNotification({message:"phone number can't be empty",type:"error"});return!1}))}));

//# sourceMappingURL=otp.min.js.map